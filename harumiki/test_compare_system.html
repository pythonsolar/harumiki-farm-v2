<!DOCTYPE html>
<html>
<head>
    <title>Test Compare System</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Test Compare System</h1>
    
    <div>
        <select id="chartSelect">
            <option value="">Choose chart...</option>
            <option value="pm">PM 2.5</option>
            <option value="co2">CO2</option>
        </select>
        <button id="loadBtn" disabled>Load Chart</button>
    </div>
    
    <div id="status"></div>
    <div id="result"></div>
    
    <script>
    const chartSelect = document.getElementById('chartSelect');
    const loadBtn = document.getElementById('loadBtn');
    const status = document.getElementById('status');
    const result = document.getElementById('result');
    
    chartSelect.addEventListener('change', function() {
        loadBtn.disabled = !this.value;
    });
    
    loadBtn.addEventListener('click', async function() {
        const chartType = chartSelect.value;
        status.innerHTML = 'Loading...';
        
        try {
            const response = await fetch(`/api/compare-chart-data/?chart_type=${chartType}&month=6&year=2025&start_date=2025-07-01&end_date=2025-07-20`, {
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            });
            
            const data = await response.json();
            status.innerHTML = 'Success!';
            
            if (data.meta) {
                result.innerHTML = `
                    <p>Chart Type: ${data.meta.chart_type}</p>
                    <p>Sensors: ${data.meta.sensors_with_data}/${data.meta.total_sensors} have data</p>
                    <p>Date Range: ${data.meta.date_range}</p>
                `;
            }
            
        } catch (error) {
            status.innerHTML = 'Error: ' + error.message;
        }
    });
    </script>
</body>
</html>